<!DOCTYPE html>
<html>
<head>
  <title>Zoe's Animal Quetionnaire!</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <link rel="stylesheet" href="screen.css">

  <script type="text/javascript">
    // Create an array of our animals
    const animals = [
      { name: "panda", fullName: "Red Panda", emoji: "🐼" },
      { name: "fish", fullName: "Beta Fish", emoji: "🐟" },
      { name: "bear", fullName: "Polar Bear", emoji: "🐻" },
      { name: "squirrel", fullName: "Squirrel", emoji: "🐿" },
      { name: "osprey", fullName: "Osprey", emoji: "🦅" },
      { name: "iguana", fullName: "Iguana", emoji: "🦎" },
      { name: "bobcat", fullName: "Bobcat", emoji: "🐈" },
      { name: "zebra", fullName: "Zebra", emoji: "🦓" }
    ]

    // Store answers as they roll in
    let answers = []

    // Update the answers as you select radio buttons
    $(document).on("change", "input[type=radio]", function(event) {
      const selectedAnswers = event.target.value.split(",")
      // const previousAnswers = $(event.target).closest("section").data("selectedAnswers")

      // Remove previous answers
      // answers = answers.filter((el) => !previousAnswers.includes(el))

      // Add the selections to the answers array
      answers.push(selectedAnswers)

      // Store selected value on the parent <section> element
      // $(event.target).closest("section").data("selectedAnswers", selectedAnswers)

      console.log(answers)
    })

    // Click the button to tabulate your result
    $(document).on("click", "[data-behavior~=tabulate-result]", function(event) {
      event.preventDefault()

      const answer = mode([].concat.apply([], answers))

      // Display your animal
      alert("You're a: " + getAnimal(answer).fullName)

      // Reset the form
      $('form').get(0).reset()

      // Reset the animals array
      answers = []
    })


    // Find the full name and emoji of the selected animal
    function getAnimal(answer) {
      return animals.find(function(obj) { return obj.name === answer })
    }

    // Find the most frequent, unique item in the merged array
    function mode(arr) {
      return arr.sort((a,b) =>
          arr.filter(v => v===a).length
        - arr.filter(v => v===b).length
      ).pop()
    }
  </script>
</head>

<body>
  <div class="container">
    <h1>Which Animal are You?</h1>
    <p>
      Answer the questions below and we’ll figure out which animal you are.
      Be sure to answer every question so the zookeeper can do her magic!
    </p>

    <form action="#" method="" id="animalForm">
      <section class="question">
        <fieldset>
          <legend><strong>Do you like mammals?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[mammals]" value="panda,bear,squirrel,bobcat,zebra"> Yes</label></dd>
            <dd><label><input type="radio" name="question[mammals]" value="fish,osprey,iguana"> No</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Which cat do you like better?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[bigcats]" value="fish,bobcat"> Tigers</label></dd>
            <dd><label><input type="radio" name="question[bigcats]" value="zebra,bobcat"> Cheetahs</label></dd>
            <dd><label><input type="radio" name="question[bigcats]" value="iguana,bobcat"> Jaguars</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Which reptile do you like better?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[reptiles]" value="iguana,osprey"> Alligator</label></dd>
            <dd><label><input type="radio" name="question[reptiles]" value="iguana,jaguar"> Crocodile</label></dd>
            <dd><label><input type="radio" name="question[reptiles]" value="iguana,squirrel"> Turtle</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Do you like rodents?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[rodents]"> Yes</label></dd>
            <dd><label><input type="radio" name="question[rodents]"> No</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>What's better?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[texture]"> Leathery</label></dd>
            <dd><label><input type="radio" name="question[texture]"> Feathery</label></dd>
            <dd><label><input type="radio" name="question[texture]"> Fuzzy</label></dd>
            <dd><label><input type="radio" name="question[texture]"> Slippery</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Where would you rather live?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[location]"> In the Arctic</label></dd>
            <dd><label><input type="radio" name="question[location]"> At the equator</label></dd>
            <dd><label><input type="radio" name="question[location]"> Somewhere in between</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Are you a day person or a nigh person?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[daynight]"> Day</label></dd>
            <dd><label><input type="radio" name="question[daynight]"> Night</label></dd>
          </dl>
        </fieldset>
      </section>

      <section class="question">
        <fieldset>
          <legend><strong>Which is tastier?</strong></legend>
          <dl>
            <dd><label><input type="radio" name="question[taste]"> Meat</label></dd>
            <dd><label><input type="radio" name="question[taste]"> Vegetables</label></dd>
            <dd><label><input type="radio" name="question[taste]"> Insects</label></dd>
            <dd><label><input type="radio" name="question[taste]"> Insects</label></dd>
          </dl>
        </fieldset>
      </section>

      <footer class="submit-buttons">
        <p>
          <input type="submit" value="Sort me now!" data-behavior="tabulate-result">
        </p>
      </footer>
    </form>
  </div>
</body>
